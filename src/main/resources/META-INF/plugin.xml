<!-- Plugin Configuration File. Read more: https://plugins.jetbrains.com/docs/intellij/plugin-configuration-file.html -->
<idea-plugin>
    <version>1.0.0</version>

    <id>com.github.audichuang.codesnap</id>
    <depends>com.intellij.modules.platform</depends>
    <depends>com.intellij.modules.vcs</depends>
    <depends>Git4Idea</depends>

    <name>CodeSnap</name>
    <vendor email="audiapplication880208@gmail.com" url="https://github.com/audichuang">audichuang</vendor>

    <!-- https://plugins.jetbrains.com/docs/marketplace/best-practices-for-listing.html -->
    <description><![CDATA[
    <p><b>CodeSnap</b> - The ultimate code sharing tool for developers. Quickly copy file contents with smart formatting, perfect for sharing with AI assistants like ChatGPT, Claude, and Gemini.</p>
    <h2>Key Features:</h2>
    <ul>
        <li>Copy multiple files/directories with customizable headers</li>
        <li>Git integration: Copy from staging area, changes view, and commit history</li>
        <li>Paste and restore: Recreate files from copied content</li>
        <li>Advanced filtering: Include/exclude paths and patterns</li>
        <li>Smart statistics: File count, lines, words, and token estimates</li>
    </ul>
    ]]>
    </description>

    <change-notes><![CDATA[
    <h2>Version 1.0.0 - Initial Release</h2>
    <ul>
      <li>Copy files and directories with customizable formatting</li>
      <li>Git staging area and commit history support</li>
      <li>Paste and restore files from clipboard</li>
      <li>Advanced path and pattern filtering</li>
      <li>Supports IntelliJ IDEA 2024.3 to 2025.2</li>
    </ul>
    ]]>
    </change-notes>

    <extensions defaultExtensionNs="com.intellij">
        <notificationGroup id="CodeSnap" displayType="BALLOON" isLogByDefault="true" />

        <projectConfigurable
            id="CodeSnapConfigurable"
            displayName="CodeSnap Settings"
            instance="com.github.audichuang.codesnap.CopyFileContentConfigurable"/>
    </extensions>
    <actions>
        <!-- For general IntelliJ IDEs -->
        <action id="CodeSnapCopyAction"
                class="com.github.audichuang.codesnap.CopyFileContentAction"
                text="CodeSnap: Copy to Clipboard"
                description="Copy folder and file content to the clipboard.">
            <add-to-group group-id="CutCopyPasteGroup" anchor="after" relative-to-action="CopyPaths"/>
        </action>
        <action id="CodeSnapCopyAllTabsAction"
                class="com.github.audichuang.codesnap.CopyAllOpenTabsAction"
                text="CodeSnap: Copy All Open Tabs"
                description="Copy the content of all open editor tabs to the clipboard.">
            <add-to-group group-id="EditorTabPopupMenu" anchor="after" relative-to-action="CopyPaths"/>
        </action>

        <!-- For Rider -->
        <action id="CodeSnapCopyActionRider"
                class="com.github.audichuang.codesnap.CopyFileContentAction"
                text="CodeSnap: Copy to Clipboard"
                description="Copy folder and file content to the clipboard.">
            <add-to-group group-id="CopyReferencePopupGroup" anchor="after" relative-to-action="CopyPaths"/>
        </action>

        <!-- Paste and Restore Files Action -->
        <action id="CodeSnapPasteAction"
                class="com.github.audichuang.codesnap.PasteAndRestoreFilesAction"
                text="CodeSnap: Paste and Restore Files"
                description="Parse clipboard content and restore files to the project.">
            <add-to-group group-id="CutCopyPasteGroup" anchor="after" relative-to-action="CodeSnapCopyAction"/>
            <add-to-group group-id="ProjectViewPopupMenu" anchor="after" relative-to-action="$Paste"/>
            <keyboard-shortcut keymap="$default" first-keystroke="ctrl shift alt V"/>
        </action>

        <!-- Git Changes Copy Action - Copy full file content (not diff patch) -->
        <action id="CodeSnapGitCopyAction"
                class="com.github.audichuang.codesnap.CopyGitFilesContentAction"
                text="CodeSnap: Copy Full Source"
                description="Copy the complete file content of selected changes with change type labels ([NEW], [MODIFIED], [DELETED]).">
            <!-- Local Changes window (Commit tool window) -->
            <add-to-group group-id="ChangesViewPopupMenu" anchor="after" relative-to-action="CopyPaths"/>
            <!-- Git Log window (Version Control history) -->
            <add-to-group group-id="Vcs.Log.ContextMenu" anchor="after" relative-to-action="CopyPaths"/>
            <!-- Git Log - Changed Files Browser -->
            <add-to-group group-id="Vcs.Log.ChangesBrowser.Popup" anchor="after" relative-to-action="CopyPaths"/>
            <!-- Git Staging Area - Unstaged files -->
            <add-to-group group-id="Git.Stage.Local.File.Menu" anchor="last"/>
            <!-- Git Staging Area - Staged files -->
            <add-to-group group-id="Git.Stage.Index.File.Menu" anchor="last"/>
            <!-- Git Staging Area - Tree menu -->
            <add-to-group group-id="Git.Stage.Tree.Menu" anchor="last"/>
        </action>
    </actions>
</idea-plugin>
